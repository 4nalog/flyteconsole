import { getCacheKey } from 'components/Cache';
import { useMemo } from 'react';
import { useTaskExecutions } from './useTaskExecutions';

/** Decorates a fetchable list of TaskExecutions generated by `useTaskExecutions`,
 * mapping the list items to `DetailedTaskExecution`s.
 */
export function useDetailedTaskExecutions(
    taskExecutionsFetchable: ReturnType<typeof useTaskExecutions>
) {
    const { value: taskExecutions } = taskExecutionsFetchable;

    return {
        ...taskExecutionsFetchable,
        value: useMemo(
            () =>
                taskExecutions.map(execution => ({
                    ...execution,
                    cacheKey: getCacheKey(execution.id)
                })),
            [taskExecutions]
        )
    };
}
